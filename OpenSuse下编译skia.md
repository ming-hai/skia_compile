# 本文档介绍OpenSuse系统中使用LLVM或者gcc编译Skia源码的方法 - 修改日期：2025-06-06 - 操作系统：OpenSuse Leap 15.6（桌面环境：KDE X11） - 编译器：LLVM or gcc - 说明1：本文档介绍OpenSuse系统中使用LLVM或者gcc编译Skia源码的方法 - 说明2：该编译Skia源码的方法，是为了适配[nim duilib](https://github.com/rhett-lee/nim_duilib)项目使用Skia库，如果用于其他库使用，可能需要修改编译参数 - 说明3：获取skia源码后，需要更新部分源码（更新方法见后续文档），否则编译无法通过。（使用了一个第三方库：expat） - 说明4：操作过程中，假设源码的根目录是`~/develop`目录，如果使用其他目录，可替换为实际的目录。## 一、准备工作：安装必备的软件1. 安装完成系统后，需要做的工作：    - 升级系统：`sudo zypper refresh; sudo zypper update -y`  2. 安装依赖的软件```sudo zypper install -y gcc gcc-c++ gdb make git ninja gn python cmake \                       llvm clang unzip fontconfig-devel Mesa-libGL-devel \                       Mesa-libEGL-devel Mesa-libGLESv3-devel glu-devel vulkan-devel```安装完成后的各个软件版本信息如下：```没有 'gn-0.20250306-bp156.2.6.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'gcc-c++-7-3.9.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'cmake-3.28.3-150600.1.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'git-2.43.0-150600.3.9.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'gcc-7-3.9.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'make-4.2.1-7.3.2.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'gdb-14.2-150400.15.23.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'unzip-6.00-150000.4.14.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'ninja-1.10.0-1.24.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'python-2.7.18-150000.77.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'clang-17-bp156.1.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'fontconfig-devel-2.14.2-150600.1.3.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'Mesa-libGLESv3-devel-23.3.4-150600.83.3.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'llvm-17-bp156.1.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'vulkan-devel-1.3.275.0-150600.1.2.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'Mesa-libGL-devel-23.3.4-150600.83.3.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'Mesa-libEGL-devel-23.3.4-150600.83.3.1.x86_64' 的更新候选。已安装了可获取的最高版本。没有 'glu-devel-9.0.0-8.45.x86_64' 的更新候选。已安装了可获取的最高版本。```## 二、如果只关心结果，直接用下列脚本一键完成所有操作，后续文档就不用再看了。选定一个工作目录，创建一个脚本`build.sh`，将下面已经整理好脚本复制进去，保存文件。    然后在控制台，为脚本文件添加可执行权限，最后运行该脚本： ```chmod +x build.sh./build.sh```脚本文件内容如下：    ```#!/bin/bashgit clone https://github.com/rhett-lee/skia_compilechmod +x ./skia_compile/linux/build_skia_all_in_one.sh./skia_compile/linux/build_skia_all_in_one.sh```编译时如果获取skia_compile代码失败，可以多重试几次。    编译完成的库文件在工作目录的`skia/out`子目录中，按编译选项放在相应的子目录。    ## 三、获取skia源码并更新修改代码1. 获取skia源码：    ```#!/bin/bashmkdir ~/develop  cd ~/developgit clone https://github.com/google/skia.gitgit -C ./skia checkout 290495056ba5b737330ae7f2e6e722eeda9526f8```2. 下载源码和文档，并更新skia的修改代码：    ```#!/bin/bashcd ~/developgit clone https://github.com/rhett-lee/skia_compileunzip -o ./skia_compile/skia.2025-06-06.src.zip -d ./skia/``` 更新完成后，可以到skia目录中确认一下是否更新成功```#!/bin/bashcd ~/developgit -C ./skia status``` ## 四、编译skia（编译器：LLVM）1. 进入skia源码目录：    \> `cd ~/develop/skia`2. 编译skia静态库（llvm.x64.Release） - `gn gen out/llvm.x64.release --args="target_cpu=\"x64\" cc=\"clang\" cxx=\"clang++\" is_trivial_abi=false is_official_build=true skia_use_libwebp_encode=false skia_use_libwebp_decode=false skia_use_libpng_encode=false skia_use_libpng_decode=false skia_use_zlib=false skia_use_libjpeg_turbo_encode=false skia_use_libjpeg_turbo_decode=false skia_enable_fontmgr_win_gdi=false skia_use_icu=false skia_use_expat=false skia_use_xps=false skia_enable_pdf=false skia_use_wuffs=false skia_enable_svg=true skia_use_expat=true skia_use_system_expat=false is_debug=false extra_cflags=[\"-DSK_DISABLE_LEGACY_PNG_WRITEBUFFER\"]"`     - `ninja -C out/llvm.x64.release` ## 五、编译skia（编译器：gcc/g++，如果不使用LLVM编译器，也可选择用gcc/g++编译）1. 进入skia源码目录：    \> `cd ~/develop/skia`2. 编译skia静态库（gcc.x64.release） - `gn gen out/gcc.x64.release --args="target_cpu=\"x64\" cc=\"gcc\" cxx=\"g++\" is_trivial_abi=false is_official_build=true skia_use_libwebp_encode=false skia_use_libwebp_decode=false skia_use_libpng_encode=false skia_use_libpng_decode=false skia_use_zlib=false skia_use_libjpeg_turbo_encode=false skia_use_libjpeg_turbo_decode=false skia_enable_fontmgr_win_gdi=false skia_use_icu=false skia_use_expat=false skia_use_xps=false skia_enable_pdf=false skia_use_wuffs=false skia_enable_svg=true skia_use_expat=true skia_use_system_expat=false is_debug=false extra_cflags=[\"-DSK_DISABLE_LEGACY_PNG_WRITEBUFFER\"]"`     - `ninja -C out/gcc.x64.release`## 六、资源链接1. Skia的编译文档库，点击访问：[skia compile](https://github.com/rhett-lee/skia_compile) 2. nim duilib的代码库，点击访问：[nim duilib](https://github.com/rhett-lee/nim_duilib) 